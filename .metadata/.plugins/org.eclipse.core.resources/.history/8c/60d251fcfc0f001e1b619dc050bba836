<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="css/support/supportDetail.css">    
</head>
<script src="https://code.jquery.com/jquery-3.6.1.min.js"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js" integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V" crossorigin="anonymous"></script>
<style>
@import url("https://fonts.googleapis.com/css?family=Poppins:200,300,400,500,600,700,800,900&display=swap");
body {
	min-height: 100%;
}

.login {
	margin-left: 300px;
}
	
 .carousel {
	width: 90%;
	height: 90%; /* 원하는 크기로 조절 */
	position: relative;
	overflow: hidden;
	border-radius: 5px;
	display: flex;
	justify-content: center;
	align-items: center;
	top: 40%;
	left: 50%;
	transform: translate(-50%, -50%);
}

.carousel img {
	width: auto;
	height: 100%;
	object-fit: cover;
}

</style>

<body>
<div th:replace="~{../common/header :: header}"></div>
<div class="supportBigBigSection">
    <div class="supportBigSection">
        <div class="supDetailSection supDetailSection1">
            <section id="supportDetailSection">


                <div class="path">
                    <a class="middle" href="#"><img class="homeIconSize" src="image/home.png"></a>
                    <img class="sub iconSize" src="image/onenext.png">
                    <a class="middle" href="#">모금함</a>
                    <img class="sub iconSize" src="image/onenext.png">
                    <a class="middle">후원 상세</a>
                </div>


                <div>
                    <div class="supportTitle">[[${s.supportTitle}]]</div>
					 <div>
                    	<img th:src="@{${s.imageUrl}}">
                    </div>
                    <div class="supportSubTitle">모금함 소개</div>

				<div id="summernote" style="margin-right:25px;"></div>
                </div>
            </section>
        </div>
        
        <div class="supDetailSection supDetailSection2">
            <section id="supportSummarySection">
                <div id="progressPercent">[[${(s.fundAmount*100/s.targetAmount)}]]%</div>

                <div>
                    <progress id="supportProgress" th:value="${(s.fundAmount*100/s.targetAmount)}" min="0" max="100"></progress>
                </div>

                <div class="supportDuration">
		            [[${#dates.format(s.startDate, 'yyyy.MM.dd')}]] ~ [[${#dates.format(s.endDate, 'yyyy.MM.dd')}]]
                </div>

                <div class="supportDeadline" th:if="${dDay>0}">
                    D-[[${dDay}]]
                </div>
                <div class="supportDeadline" th:if="${dDay==0}">
                    D-day
                </div>
                <div class="supportDeadline" th:if="${dDay<0}">
                    D+[[${-dDay}]]
                </div>

                <div class="totalDonation">
                    	[[${s.fundAmount}]]원
<!--                    <script th:inline="javascript">-->
<!--			        /*<![CDATA[*/ -->
<!--                     	var amount = /*[[${s.fundAmount}]]*/'0'; // 숫자 변수 -->
<!-- 				        var formattedAmount = amount.toLocaleString(); // 원하는 형식으로 포맷 -->
<!-- 				        document.write(formattedAmount + '원'); // 포맷된 값을 출력 -->
<!-- 				        /*]]*/ -->
				    </script>
                </div>

                <div class="donationButton" th:if="${dDay >= 0}">
                    <button class="learn-more supportButton" th:onclick="|location.href='doSupport.su?supportNo=${s.supportNo}'|">모금함 기부하기</button>
                </div>
                <div class="donationButton" th:if="${dDay < 0}" style="font-size:30px; color:grey;">
					모금이 종료되었습니다.
                </div>

                <div class="supportSubTitle2">
                	모금 단체<br><span>[[${s.registar}]]</span>
                </div>
                <div class="supportSubTitle2 groupInfo">
                	<b>선뜻 가입일</b> &nbsp;&nbsp; <span>[[${#dates.format(s.enrollDate, 'yyyy.MM.dd')}]]</span><br>
                	<b>문의 전화</b>&nbsp;&nbsp; <span>0[[${s.phone}]]</span>
                </div>
                
                
                    <div class="supportSubTitle">참여 내역</div>

                    <div class="supportDate">
                        2023.06.02 15:03
                    </div>
                    <div class="sponsor">
                        숨은 천사 100원 참여
                    </div>

                    <div class="supportDate">
                        2023.06.01 09:15
                    </div>
                    <div class="sponsor">
                        강건강 100원 참여
                    </div>

                    <div class="supportDate">
                        2023.05.31 18:53
                    </div>
                    <div class="sponsor">
                        숨은 천사 5000원 참여
                    </div><br><br><br>
                
            </section>
        </div>
    </div>
       
<div th:replace="~{../common/footer :: footer}"></div>

<script th:inline="javascript">
    	/*<![CDATA[*/
	    document.getElementById('summernote').innerHTML = /*[[${s.supportContent}]]*/5;
    	
    	window.onload=()=>{
    		let timer = setTimeout(function tick () {
    			$.ajax({
                	url: 'reloadDetail.su',
    				data: {
    					supportNo :/*[[${s.supportNo }]]*/'0'    						
    				},
    				success: data=>{
    					console.log(data);
    					
    					document.getElementsByClassName('totalDonation')[0].innerHTML = '[[${s.fundAmount}]]원';

    					document.getElementById('supportProgress').value = '[[${s.fundAmount*100/s.targetAmount}]]';
    					document.getElementById('progressPercent').innerText = '[[${s.fundAmount*100/s.targetAmount}]]%'
    				},
    				error: data=>{
    					console.log(data);
    				}
                })
    			
    			
    			
    		    
    		    let timer = setTimeout(tick, 5000)
    		}, 5000)
    	}
    	/*]]>*/
</script>
</body>
</html>