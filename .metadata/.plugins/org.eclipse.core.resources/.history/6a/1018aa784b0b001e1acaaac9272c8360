package com.fin.proj.volunteer;

import java.io.UnsupportedEncodingException;
import java.net.URI;
import java.net.URISyntaxException;
import java.net.URLEncoder;
import java.util.HashMap;

import org.springframework.http.HttpEntity;
import org.springframework.http.HttpHeaders;
import org.springframework.http.HttpMethod;
import org.springframework.http.ResponseEntity;
import org.springframework.web.client.RestTemplate;

import com.google.gson.JsonArray;
import com.google.gson.JsonObject;
import com.google.gson.JsonParser;

public class Map {
	private Map() {}
	
	public static HashMap<String, String> getLongitudeAndLatitude(String address) {
		final String API_KEY = "1d406575d6e9075005c02670b76f0612";
		String encodedAddress = null;
		URI uri = null;
		try {
			encodedAddress = URLEncoder.encode(address, "UTF-8");
			String rawURI = "https://dapi.kakao.com/v2/local/search/address.json?query=" + encodedAddress;
			uri = new URI(rawURI);
		} catch (UnsupportedEncodingException | URISyntaxException e) {
			e.printStackTrace();
		} 
		
		HttpHeaders headers = new HttpHeaders();
		headers.add("Authorization", "KakaoAK " + API_KEY);
		
		RestTemplate restTemplate = new RestTemplate();
		ResponseEntity<String> result = restTemplate.exchange(uri, HttpMethod.GET, new HttpEntity(headers), String.class);
		
//		System.out.println(result.getBody());
		JsonParser jsonParser = new JsonParser();
		JsonObject body = (JsonObject) jsonParser.parse(result.getBody());
		JsonArray jsonArray = (JsonArray)body.get("documents");
		
		JsonObject local = (JsonObject)jsonArray.get(0);
		JsonObject jsonArray1 = (JsonObject)local.get("address");
		
		System.out.println(jsonArray1);
		return null;
	}
}
